# Configuration du serveur principal (HTTP)
server {
    # Paramètres de base
    port=8080
    host=127.0.0.1
    server_name=localhost

    # Paramètres globaux
    root=/var/www/html

    # Pages d'erreur personnalisées
    error_page=404 /404.html
    error_page=500 /500.html
    error_page=403 /403.html

    # Location par défaut
    location / {
        allowed_methods=GET POST
        index=index.html index.htm
        autoindex=off
        client_max_body_size=1M
    }

    # Gestion des uploads
    location /upload {
        allowed_methods=POST
        root=/var/www/uploads
        autoindex=off
        client_max_body_size=20M
    }

    # API REST
    location /api {
        allowed_methods=GET POST PUT DELETE
        index=api.html
        autoindex=on
        client_max_body_size=5M
    }

    # Support CGI
    location /cgi-bin {
        allowed_methods=GET POST
        autoindex=off
        cgi_pass=.php /usr/bin/php-cgi
        cgi_pass=.py /usr/bin/python3
        client_max_body_size=10M
    }
}

# Configuration du serveur API
server {
    # Paramètres de base
    port=8081
    host=127.0.0.1
    server_name=api.localhost

    # Paramètres globaux
    root=/var/www/api
    
    # Pages d'erreur pour l'API
    error_page=404 /errors/404.json
    error_page=500 /errors/500.json

    # Configuration API
    location / {
        allowed_methods=GET POST PUT DELETE
        index=index.json
        autoindex=on
        client_max_body_size=50M
    }

    # Documentation API
    location /docs {
        allowed_methods=GET
        index=api-docs.html
        autoindex=off
        client_max_body_size=1M
    }
}
