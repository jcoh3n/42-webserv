# Configuration du serveur principal (HTTP)
server {
    # Paramètres de base
    port=8080
    host=127.0.0.1
    server_name=localhost

    # Paramètres globaux
    root=./www

    # Pages d'erreur personnalisées
    error_page=404 error/404.html
    error_page=500 error/500.html
    error_page=403 error/403.html

    # Location par défaut
    location / {
        allowed_methods=GET POST
        index=index.html index.htm
        autoindex=off
        client_max_body_size=1M
    }

    # Configuration CGI
    location /cgi-bin {
        allowed_methods=GET POST
        root=./www/cgi-bin
        cgi_ext=.php
        cgi_handler=/usr/bin/php-cgi
        client_max_body_size=10M
        autoindex=off
    }

    # Gestion des uploads
    location /upload {
        allowed_methods=POST
        root=./www/uploads
        autoindex=off
        client_max_body_size=20M
    }

    # API REST
    location /api {
        allowed_methods=GET POST PUT DELETE
        index=api.html
        autoindex=on
        client_max_body_size=5M
    }
}

# Configuration du serveur API
server {
    # Paramètres de base
    port=8081
    host=127.0.0.1
    server_name=api.localhost

    # Paramètres globaux
    root=./www/api
    
    # Pages d'erreur pour l'API
    error_page=404 error/404.html
    error_page=500 error/500.html

    # Configuration API
    location / {
        allowed_methods=GET POST PUT DELETE
        index=index.json
        autoindex=on
        client_max_body_size=50M
    }
}
